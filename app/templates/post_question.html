
{% extends 'base.html' %}
{% block content %}
<form action='/home/post/process' method='post' enctype="multipart/form-data">
    <label>Short Description of your questions
        <textarea rows="4" cols="50" name="description"></textarea>
    </label>
    <div>
        <div class="text choice">
            <label>Option 1
                <textarea rows="4" cols="20" name="option1"></textarea>
            </label>
        </div>
        <div class="image choice">
            <label>Upload image
                <input type="file" name="fileupload1">
            </label>
        </div>
    </div>
    </div>

    <div>
        <div class="text choice">
            <label>Option 2
                <textarea rows="4" cols="20" name="option2"></textarea>
            </label>
        </div>
        <div class="image choice">
            <label>Upload image
                <input type="file" name="fileupload2">
            </label>
        </div>
    </div>
    <br>

    <div id="tags">
        <label>Enter your tags here</label>
        <br>
        <input class="form-control tm-input tm-input-info typeahead" type="text" placeholder="Tags" name="tags">
    </div>
    <br>
    <br>
    <br>
    <input type="submit">
</form>

<script src="https://code.jquery.com/jquery.js"></script>
<!-- jQuery/AJAX -->
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
<!--Tag Manager -->
<script src="../static/tag/tagmanager.js"></script>
<!-- Bloodhound & Typeahead -->
<script src="../static/typeahead/bloodhound.js"></script>
<script src="../static/typeahead/typeahead.bundle.js"></script>
<script src="../static/typeahead/typeahead.jquery.js"></script>

<script>

    var new_list = {{ tags_list|safe }};
    console.log(new_list);

    jQuery(".tm-input").tagsManager({
        CapitalizeFirstLetter: true,
        AjaxPush: null,
        AjaxPushallTags: null,
        AjaxPushParameters: null,
        delimiters:[9, 13, 44], //tab, enter, comma
        backspace: [8], //backspace removes the rightmost tag
        hiddenTagListName: 'hidden_tags',
        onlyTagList: false,
        tagList: new_list

    });

var substringMatcher = function(strs) {
  return function findMatches(q, cb) {
      if (q === '') {
          cb(new_list);
      }
      else {
          var matches, substringRegex;

    // an array that will be populated with substring matches
    matches = [];

    // regex used to determine if a string contains the substring `q`
    substrRegex = new RegExp(q, 'i');

    // iterate through the pool of strings and for any string that
    // contains the substring `q`, add it to the `matches` array
    $.each(strs, function(i, str) {
      if (substrRegex.test(str)) {
        matches.push(str);
      }
    });

    cb(matches);
  };
 };
};

function defTags(q, sync) {
    if (q === '') {
        sync(new_list);
    }
    else {
        substringMatcher(new_list);
    }
}

$('#tags .typeahead').typeahead({
  hint: true,
  highlight: true,
  minLength: 1
},
{
  name: 'states',
  source: substringMatcher(new_list)
});


</script>

{% endblock %}